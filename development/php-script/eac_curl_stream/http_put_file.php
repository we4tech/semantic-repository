<?PHP/** * http_put_file.php - receiver script for HTTP/PUT method * * PHP version 5 * * @author	   Kevin Burkholder <KBurkholder@EarthAsylum.com> *//* +------------------------------------------------------------------------+   | Copyright 2008, Kevin Burkholder               www.KevinBurkholder.com |   | Some rights reserved.                                                  |   |                                                                        |   | This work is licensed under the Creative Commons GNU Lesser General    |   | Public License. To view a copy of this license, visit                  |   |     http://creativecommons.org/licenses/LGPL/2.1/                      |   |                                                                        |   | Please see the License_LGPL_x.x.txt file for redistribution and use    |   | restrictions. If this file was not included with the distribution of   |   | this software, it may be found here:                                   |   |     http://www.kevinburkholder.com/sw_license.php                      |   |                                                                        |   | THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS    |   | "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT      |   | LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR  |   | A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   |   | OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  |   | SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT       |   | LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,  |   | DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  |   | THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT    |   | (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE  |   | OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.   |   |                                                                        |   +------------------------------------------------------------------------+   |                                                                        |   | Author:     Kevin Burkholder                                           |   |             EarthAsylum Consulting                                     |   |             KBurkholder@EarthAsylum.com                                |   |                                                                        |   +------------------------------------------------------------------------+ *//** * setup in .htaccess: * * 1. deny access to files (specifically "put" for this example): *      <FilesMatch "\.(htaccess|htpasswd|inc|cache|put)$"> *        Order Allow,Deny *        Deny from all *      </FilesMatch> * * 2. Set this script for PUT method: *      RewriteCond %{REQUEST_METHOD} ^PUT$ *      RewriteCond %{REQUEST_URI} ^(.*)/upload/(.*)$ *      RewriteCond %{REQUEST_URI} !http_put_file\.php *      RewriteRule ^(.*)$ /upload/http_put_file.php [l] */ if ($_SERVER['REQUEST_METHOD'] == "PUT") {	// don't allow PUT of this script	if ($_SERVER['REQUEST_URI'] == $_SERVER['SCRIPT_NAME']) {		header("HTTP/1.1 403 Forbidden");		die('403 Forbidden');	}	// should have some kind of authorization	if (!isset($_SERVER['PHP_AUTH_USER']) || !isset($_SERVER['PHP_AUTH_PW'])) {		header('HTTP/1.1 401 Unauthorized');		die('Authorization required');	}	// change directory to upload folder	chdir($_SERVER['DOCUMENT_ROOT']."/upload");	// save the file as "username[file_name].put"	file_put_contents	(	$_SERVER['PHP_AUTH_USER']."[".basename($_SERVER['REQUEST_URI'])."].put",							file_get_contents("php://input") 						);	header("HTTP/1.1 201 Created");}	else{	// only PUT method for this script	header("HTTP/1.1 405 Method Not Allowed");	die('405 Method Not Allowed');}?>